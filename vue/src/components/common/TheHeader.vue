<script setup lang="ts">
import { ref, onMounted } from 'vue';
import { RouterLink } from 'vue-router';
import Navigation from './TheNavigation.vue';

const emit = defineEmits(['headerHeightChange']);

const header = ref<HTMLElement | null>(null);
let debounceHeight = ref<Number | undefined>();
let heightTimeout = ref<any>();

onMounted(() => {
    emit('headerHeightChange', header.value?.clientHeight);
});

window.addEventListener('resize', () => {
    if (debounceHeight.value === header.value?.clientHeight) return;
    if (heightTimeout.value) clearTimeout(heightTimeout.value);
    heightTimeout.value = setTimeout(() => {
        emit('headerHeightChange', header.value?.clientHeight);
    }, 250);
});

// 2nd way of passing props to a parent
// const props = defineProps({
//     headerHeightValue: {
//         type: Function
//     }
// });
// window.addEventListener('resize', () => {
//     if (props.headerHeightValue) {
//         props.headerHeightValue(header.value?.clientHeight);
//     }
// })

</script>
<template>
    <header class="sticky top-0 z-50 bg-blue-500/90" ref="header">
        <div class="header-nav padded-container py-5 flex flex-wrap justify-center lg:justify-between gap-5">
            <RouterLink to="/" aria-label="MB electronic homepage">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 783 129" fill="none"
                    class="w-full cursor-pointer max-w-[10rem]">
                    <path fill="#FFFFFF"
                        d="M228.292.502c-22.27-.073-46.864 1.865-72.437 6.094-16.97 2.806-33.182 6.437-48.281 10.656l2.093 4.25a489.861 489.861 0 0 1 32.907-7.219c86.639-15.927 162.775-6.798 169.937 20.375 7.163 27.173-57.361 62.167-144 78.094-68.11 12.52-129.719 9.573-156.437-5.469 25.027 20.135 90.87 26.903 164.937 14.657 59.646-9.862 109.89-29.617 135.75-51.032a18.088 18.088 0 0 1-.562-4.562c0-6.049 2.531-11.08 7.625-15.063 3.186-2.491 6.88-4.182 11.062-5.125-1.945 8.184-8.27 16.59-18.125 24.75 1.012 3.916 3.388 7.318 7.125 10.188 5.125 3.91 11.757 5.875 19.906 5.875 5.253 0 9.805-.716 13.625-2.125a25.216 25.216 0 0 0 9.813-6.594l-10.969-3.937c-3.502 2.599-7.692 3.906-12.562 3.906-4.075 0-7.42-.817-10.063-2.469-2.61-1.676-4.239-3.932-4.844-6.75h41.875l.063-1.906c0-6.559-2.563-11.83-7.688-15.813-5.125-4.008-11.788-6-19.968-6-2.912 0-5.645.272-8.188.844.726-3.069.829-6.11.281-9.094C326.971 14.158 285.207.69 228.292.502Zm-118.625 21c-9.208 2.358-18.033 4.896-26.406 7.625L69.5 83H88l11.636-43.06L121 83h17.5l22.074-43.06L171.5 83H190l-17-68h-19l-23.927 47.627-20.406-41.125Zm-26.406 7.625 1.219-4.656C53.044 35.423 28.778 49.363 14.199 63.002c21.008-14.26 39.015-24.08 69.062-33.875Zm1.219-4.656a385.797 385.797 0 0 1 23.094-7.219L106.5 15H87l-2.52 9.471Zm628.719 5.5c-2.292 0-4.252.636-5.875 1.875-1.624 1.239-2.438 2.72-2.438 4.469 0 1.821.814 3.368 2.438 4.656 1.655 1.263 3.644 1.906 5.968 1.906 2.26 0 4.19-.636 5.813-1.875 1.623-1.263 2.437-2.758 2.437-4.531 0-1.798-.813-3.33-2.468-4.594-1.624-1.263-3.584-1.906-5.875-1.906Zm-337.313 1.031V85.94h13.031V31.002h-13.031Zm151.75.688v14.593h-6.687v8.563h6.687V85.94h13V54.846h7.719v-8.563h-7.719V31.69h-13ZM425.23 45.283c-7.704 0-14.125 1.992-19.25 6-5.093 3.984-7.656 9.014-7.656 15.063 0 5.902 2.562 10.815 7.687 14.75 5.125 3.91 11.788 5.875 19.938 5.875 5.252 0 9.773-.716 13.593-2.125 3.82-1.433 7.106-3.63 9.844-6.594l-11-3.937c-3.502 2.599-7.66 3.906-12.531 3.906-4.075 0-7.452-.817-10.094-2.469-2.61-1.676-4.208-3.932-4.812-6.75h41.875l.03-1.906c0-6.559-2.562-11.83-7.687-15.813-5.125-4.008-11.756-6-19.937-6Zm65.062 0c-5.57 0-10.605.904-15.125 2.75-4.488 1.846-7.985 4.395-10.5 7.625-2.514 3.23-3.781 6.756-3.781 10.594 0 5.538 2.593 10.37 7.75 14.5 5.189 4.13 12.333 6.219 21.469 6.219 10.154 0 18.023-2.768 23.594-8.281l-10.282-5.344c-3.247 3.036-7.768 4.531-13.593 4.531-4.712 0-8.51-1.05-11.407-3.187-2.896-2.138-4.343-4.905-4.343-8.282 0-3.473 1.476-6.32 4.468-8.531 3.024-2.235 6.974-3.344 11.844-3.344 2.674 0 4.995.306 6.969.938 2.005.631 4.025 1.779 6.062 3.406l10.844-4.562c-2.61-2.891-5.956-5.102-10.062-6.657-4.107-1.579-8.75-2.375-13.907-2.375Zm84.719 0c-2.387 0-4.588.511-6.594 1.532-2.005 1.02-3.603 2.5-4.812 4.468v-5h-11.188V85.94h12.938V69.908l-.031-1.937c0-5.538.662-9.262 2.03-11.156 1.401-1.895 3.12-2.844 5.126-2.844.987 0 2.253.292 3.781.875l4.031-8.563c-1.846-.68-3.594-1-5.281-1Zm36.188 0c-6.78 0-12.78 1.78-18 5.375-5.953 4.13-8.938 9.306-8.938 15.5 0 5.781 2.623 10.694 7.875 14.75 5.284 4.032 11.676 6.063 19.125 6.063 5.061 0 9.673-.928 13.875-2.75 4.202-1.846 7.518-4.402 9.938-7.656 2.45-3.255 3.687-6.728 3.687-10.47 0-3.716-1.206-7.2-3.625-10.405-2.42-3.207-5.796-5.724-10.125-7.594-4.297-1.87-8.91-2.813-13.812-2.813Zm66.656 0a24.79 24.79 0 0 0-7.406 1.125c-2.388.729-5.04 2.043-8 3.938v-4.063h-13V85.94h13V70.002c0-4.13.18-6.792.562-8.031.732-2.38 2.028-4.258 3.906-5.594 1.91-1.36 4.202-2.031 6.844-2.031 2.037 0 3.725.424 5.094 1.25 1.4.801 2.365 1.976 2.906 3.531.573 1.555.875 4.7.875 9.438V85.94h12.875V59.752c0-4.567-1.507-8.012-4.531-10.344-3.597-2.745-7.968-4.125-13.125-4.125Zm80.594 0c-5.571 0-10.605.904-15.125 2.75-4.489 1.846-7.986 4.395-10.5 7.625-2.515 3.23-3.782 6.756-3.782 10.594 0 5.538 2.593 10.37 7.75 14.5 5.189 4.13 12.333 6.219 21.469 6.219 10.155 0 18.023-2.768 23.594-8.281l-10.281-5.344c-3.247 3.036-7.769 4.531-13.594 4.531-4.711 0-8.51-1.05-11.406-3.187-2.897-2.138-4.344-4.905-4.344-8.282 0-3.473 1.476-6.32 4.469-8.531 3.024-2.235 6.973-3.344 11.843-3.344 2.674 0 4.995.306 6.969.938 2.005.631 4.025 1.779 6.063 3.406l10.843-4.562c-2.61-2.891-5.956-5.102-10.062-6.657-4.107-1.579-8.75-2.375-13.906-2.375Zm-51.813 1V85.94h13.094V46.283h-13.094ZM339.699 53.69c3.342 0 6.266.709 8.78 2.093 2.547 1.385 4.266 3.165 5.126 5.375h-28.219c1.464-2.453 3.062-4.153 4.781-5.125 2.738-1.554 5.903-2.343 9.532-2.343Zm86.156 0c3.342 0 6.266.709 8.781 2.093 2.547 1.385 4.234 3.165 5.094 5.375h-28.22c1.464-2.453 3.062-4.153 4.781-5.125 2.738-1.554 5.934-2.343 9.563-2.343h.001Zm185.531.937c4.138 0 7.545 1.081 10.188 3.219 2.673 2.113 4 4.88 4 8.281 0 3.4-1.357 6.182-4.063 8.344-2.706 2.162-6.082 3.219-10.156 3.219-4.075 0-7.451-1.05-10.125-3.188-2.642-2.138-3.969-4.926-3.969-8.375 0-3.352 1.326-6.112 4-8.25 2.706-2.162 6.082-3.25 10.125-3.25ZM14.642 69.956a7.071 7.071 0 1 1-14.142 0 7.071 7.071 0 0 1 14.142 0Z M207 83V15h40.481c7.438 0 13.642.742 18.611 2.225 4.97 1.483 8.705 3.541 11.207 6.175 2.501 2.612 3.752 5.623 3.752 9.032 0 2.656-.79 4.991-2.37 7.005-1.58 1.993-3.752 3.63-6.516 4.915-2.732 1.261-5.859 2.158-9.38 2.689v.664c3.85.11 7.454.841 10.811 2.192 3.39 1.35 6.138 3.242 8.245 5.677 2.106 2.413 3.159 5.29 3.159 8.633 0 3.608-1.333 6.829-3.999 9.662-2.633 2.811-6.533 5.036-11.7 6.674C264.134 82.181 257.766 83 250.196 83H207Zm21.376-11.754h17.427c5.956 0 10.301-.764 13.032-2.29 2.732-1.55 4.098-3.609 4.098-6.177 0-1.881-.675-3.541-2.024-4.98-1.349-1.439-3.275-2.568-5.776-3.387-2.468-.819-5.414-1.228-8.837-1.228h-17.92v18.062Zm0-27.79h15.847c2.929 0 5.529-.344 7.8-1.03 2.304-.709 4.114-1.705 5.43-2.989 1.35-1.283 2.024-2.822 2.024-4.615 0-2.457-1.3-4.438-3.9-5.943-2.567-1.505-6.22-2.258-10.959-2.258h-16.242v16.834Z" />
                </svg>
            </RouterLink>
            <Navigation></Navigation>
        </div>
    </header>
</template>